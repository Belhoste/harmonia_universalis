import{a as ae}from"./chunk-WMBJ7SWU.js";import{a as H,b as we,c as He,d as Te,e as Fe}from"./chunk-JJ5REURW.js";import{a as xe}from"./chunk-W4TGJWCA.js";import{a as Me}from"./chunk-VH2TM3OF.js";import{g as ye,h as De}from"./chunk-PWUDSJ2V.js";import{f as Se,g as be}from"./chunk-5ZC2UETL.js";import{a as ne,b as oe,c as re,d as le,e as se,f as me,g as pe,h as ce,i as de,j as ue,k as _e,l as he}from"./chunk-NDDQKOBX.js";import{$ as ve,I as K,J as W,Y as fe,Z as Ce,_ as ge,r as q,s as j}from"./chunk-3CUYWVWG.js";import{b as ie}from"./chunk-3H76ELPW.js";import{$a as $,Ad as te,Cb as V,Db as v,Ka as _,Oa as I,Pa as c,Ua as u,Va as z,Vc as J,W as f,Wa as O,Xa as R,Ya as n,Z as L,Za as o,_a as C,ab as B,cb as M,cc as Q,ea as x,fa as S,fb as b,hb as p,k as E,nb as y,ob as D,pb as T,rc as G,s as k,sc as N,t as A,tb as l,td as X,ub as w,ud as Y,vb as g,vd as Z,wa as P,xa as a,xd as ee}from"./chunk-6NNPIAAU.js";var Pe=["paginator"],Ie=()=>[""],ze=()=>["/prosopography"],Oe=()=>["/search"],Re=()=>[];function $e(t,s){t&1&&C(0,"mat-progress-spinner",12)}function Be(t,s){if(t&1&&(n(0,"th",23),l(1),o()),t&2){let e=p().$implicit,i=p(2);a(),g(" ",i.getHeaderLabel(e)," ")}}function Ve(t,s){if(t&1&&l(0),t&2){let e=p(2).$implicit;g(" ",e.author.label," ")}}function Qe(t,s){t&1&&(n(0,"span",25),l(1,"[Inconnu]"),o())}function qe(t,s){if(t&1&&(n(0,"button",26)(1,"mat-icon",27),l(2,"open_in_new"),o()()),t&2){let e=p(2).$implicit;c("routerLink","/item/"+e.author.id),a(),c("inline",!0)}}function je(t,s){if(t&1&&_(0,Ve,1,1)(1,Qe,2,0,"span",25)(2,qe,3,2,"button",26),t&2){let e=p().$implicit;u(e.author?0:1),a(2),u(e.author!=null&&e.author.id?2:-1)}}function Ge(t,s){if(t&1&&(n(0,"span"),l(1),o()),t&2){let e=p().$implicit;a(),w(e.title.label)}}function Ne(t,s){if(t&1&&l(0),t&2){let e=p(2).$implicit;g(" ",e.location.label," ")}}function Je(t,s){t&1&&(n(0,"span",25),l(1,"[Inconnu]"),o())}function Ke(t,s){if(t&1&&(n(0,"button",28)(1,"mat-icon",27),l(2,"open_in_new"),o()()),t&2){let e=p(2).$implicit;c("routerLink","/item/"+e.location.id),a(),c("inline",!0)}}function We(t,s){if(t&1&&_(0,Ne,1,1)(1,Je,2,0,"span",25)(2,Ke,3,2,"button",28),t&2){let e=p().$implicit;u(e.location?0:1),a(2),u(e.location!=null&&e.location.id?2:-1)}}function Xe(t,s){if(t&1&&(n(0,"span"),l(1),o()),t&2){let e=p().$implicit;a(),w(e.date.value)}}function Ye(t,s){if(t&1&&(n(0,"span"),l(1),o()),t&2){let e=p().$implicit,i=p().$implicit;a(),w(e[i])}}function Ze(t,s){if(t&1&&(n(0,"td",24),_(1,je,3,2)(2,Ge,2,1,"span")(3,We,3,2)(4,Xe,2,1,"span")(5,Ye,2,1,"span"),o()),t&2){let e,i=p().$implicit,m=p(2);I("data-label",m.getHeaderLabel(i)),a(),u((e=i)==="author"?1:e==="title"?2:e==="location"?3:e==="date"?4:5)}}function et(t,s){if(t&1&&($(0,17),_(1,Be,2,1,"th",21)(2,Ze,6,2,"td",22),B()),t&2){let e=s.$implicit;c("matColumnDef",e)}}function tt(t,s){t&1&&C(0,"tr",29)}function it(t,s){t&1&&C(0,"tr",30)}function at(t,s){if(t&1){let e=M();n(0,"div",13)(1,"table",16),O(2,et,3,1,"ng-container",17,z),_(4,tt,1,0,"tr",18)(5,it,1,0,"tr",19),o(),n(6,"mat-paginator",20,1),b("page",function(m){x(e);let r=p();return S(r.handlePageEvent(m))}),o()()}if(t&2){let e=p();a(),c("dataSource",e.dataSource),a(),R(e.displayedColumns),a(2),c("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),a(),c("matRowDefColumns",e.displayedColumns),a(),c("length",e.length)("pageSize",e.pageSize)("disabled",e.disabled)("showFirstLastButtons",e.showFirstLastButtons)("pageSizeOptions",e.showPageSizeOptions?e.pageSizeOptions:v(11,Re))("hidePageSize",e.hidePageSize)("pageIndex",e.pageIndex)}}var Ue={author:t=>t.author?.label,title:t=>t.title?.label,location:t=>t.location?.label,date:t=>t.date?.value},Rt=(()=>{class t{constructor(){this.database=f(ae),this._liveAnnouncer=f(J),this.csv=f(xe),this.lang=f(ie),this.displayedColumns=["author","title","location","date"],this.dataSource=new he,this.biblioHU="Bibliography Harmonia Universalis",this.authorHeader="Author",this.titleHeader="Title",this.locationHeader="Location",this.dateHeader="Date",this.behavior$=new E(""),this.length=50,this.pageSize=25,this.pageIndex=0,this.pageSizeOptions=[10,25,50,100,500,1e3],this.hidePageSize=!1,this.showPageSizeOptions=!0,this.showFirstLastButtons=!0,this.disabled=!1,this.isSpinner=!0,this.myLang="%20.%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22"+this.lang.selectedLang+"%22%2C%22en%22.%20%7D%0A%7D%0A"}getHeaderLabel(e){switch(e){case"author":return this.authorHeader;case"title":return this.titleHeader;case"location":return this.locationHeader;case"date":return this.dateHeader;default:return e}}ngOnInit(){this.isSpinner=!0,console.log("Spinner ON"),this.dataSource.sortingDataAccessor=(r,d)=>Ue[d]?Ue[d](r)||"":r[d]||"",this.dataSource.sortData=(r,d)=>{let h=d.active,F=d.direction;return!h||F===""?r:r.slice().sort((Ee,ke)=>{let Ae=this.dataSource.sortingDataAccessor(Ee,h),Le=this.dataSource.sortingDataAccessor(ke,h),U=Ae.localeCompare(Le,"fr",{sensitivity:"base"});return F==="asc"?U:-U})},this.biblioHU=this.lang.biblioHU(this.biblioHU),this.authorHeader=this.lang.authorHeader(this.authorHeader),this.titleHeader=this.lang.titleHeader(this.titleHeader),this.locationHeader=this.lang.locationHeader(this.locationHeader),this.dateHeader=this.lang.dateHeader(this.dateHeader);let e=this.database.sparqlBuilding(this.myLang),i=this.database.newSparqlAdress(e);this.database.initBiblioData(i);let m=this.database.getBiblioData();this.dataSource$=A([this.behavior$,m]).pipe(k(r=>(this.dataSource.filter=r[0],this.dataSource.data=r[1],this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.dataSource))),this.dataSource$.subscribe(r=>{console.log("Spinner OFF"),this.isSpinner=!1})}onClick(e){let i=e;i=this.database.databaseToDownload(e);let m=this.csv.arrayToCsv(i);this.csv.downloadBlob(m,"biblio_harmonia_universalis","text/csv;charset=utf-8;")}applyFilter(e){let i=e.target.value.trim().toLowerCase();this.dataSource.filter=i,this.dataSource.filteredData,this.filtered=this.dataSource.filteredData[0].author.label}handlePageEvent(e){this.pageEvent=e,this.length=e.length,this.pageSize=e.pageSize,this.pageIndex=e.pageIndex}setPageSizeOptions(e){e&&(this.pageSizeOptions=e.split(",").map(i=>+i))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=L({type:t,selectors:[["app-harmonia-universalis"]],viewQuery:function(i,m){if(i&1&&(y(H,5),y(Pe,5)),i&2){let r;D(r=T())&&(m.sort=r.first),D(r=T())&&(m.paginator=r.first)}},standalone:!0,features:[V],decls:32,vars:10,consts:[["content",""],["paginator",""],["href",P`https://fonts.googleapis.com/icon?family=Material+Icons`,"rel","stylesheet"],[1,"cardBackground"],[1,"hu-header"],[1,"hu-title"],[1,"search-center"],[3,"routerLink"],["appearance","outlined",1,"mat-elevation-z12"],[1,"labelTitlePadding"],["appearance","outline"],["matInput","","placeholder","Search",3,"keyup"],["mode","indeterminate","color","primary","diameter","50",2,"margin","2rem auto","display","block"],[1,"mat-elevation-z8","container"],["mat-icon-button","","color","primary",1,"internalLink",3,"click"],["color","primary",3,"inline"],["mat-table","","matSort","","matSortActive","title","matSortDirection","asc",1,"mat-table",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","","class","mat-header-row",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","responsive-row",4,"matRowDef","matRowDefColumns"],["aria-label","Select page",1,"demo-paginator",3,"page","length","pageSize","disabled","showFirstLastButtons","pageSizeOptions","hidePageSize","pageIndex"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","responsive-cell",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"responsive-cell"],[1,"text-muted"],["mat-icon-button","","matTooltip","Voir l'auteur dans la base de donn\xE9es",1,"compact-icon-btn",3,"routerLink"],["color","primary",1,"small-icon",3,"inline"],["mat-icon-button","","matTooltip","Voir le lieu dans la base de donn\xE9es",1,"compact-icon-btn",3,"routerLink"],["mat-header-row","",1,"mat-header-row"],["mat-row","",1,"responsive-row"]],template:function(i,m){if(i&1){let r=M();n(0,"head"),C(1,"link",2),o(),n(2,"body")(3,"div",3)(4,"div",4)(5,"div",5),l(6),o(),n(7,"div",6)(8,"a",7),l(9,"Accueil"),o(),n(10,"span"),l(11,"\xA0|\xA0"),o(),n(12,"a",7),l(13,"Prosopography"),o(),n(14,"span"),l(15,"\xA0|\xA0"),o(),n(16,"a",7),l(17,"FactGrid"),o()()()(),n(18,"mat-card",8)(19,"mat-card-content",3)(20,"div",9)(21,"mat-form-field",10)(22,"input",11),b("keyup",function(h){return x(r),S(m.applyFilter(h))}),o()()(),_(23,$e,1,0,"mat-progress-spinner",12)(24,at,8,12,"div",13),n(25,"div")(26,"span")(27,"button",14,0),b("click",function(){return x(r),S(m.onClick(m.dataSource.filteredData))}),n(29,"mat-icon",15),l(30,"download"),o()(),l(31," \xA0\xA0\xA0\xA0\xA0\xA0 "),o()()()()()}i&2&&(a(6),g(" ",m.biblioHU," "),a(2),c("routerLink",v(7,Ie)),a(4),c("routerLink",v(8,ze)),a(4),c("routerLink",v(9,Oe)),a(7),u(m.isSpinner?23:-1),a(),u(m.isSpinner?-1:24),a(5),c("inline",!0))},dependencies:[Q,_e,ne,re,pe,le,oe,ce,se,me,de,ue,He,H,we,W,K,Y,X,te,Z,ee,N,G,Fe,Te,ve,ge,fe,Ce,q,j,Me,be,Se,De,ye],styles:['.mat-elevation-z8.container[_ngcontent-%COMP%]{width:100%;overflow-x:auto}@media (max-width: 600px){.mat-header-row[_ngcontent-%COMP%]{display:none}.responsive-cell[_ngcontent-%COMP%]{display:block;width:100%;margin:16px 0;border:0 none;position:relative;padding:0 16px 0 110px}.responsive-cell[_ngcontent-%COMP%]:before{content:attr(data-label) ": ";position:absolute;left:16px;top:0;font-weight:700;color:#666;white-space:nowrap}.responsive-row[_ngcontent-%COMP%]{display:block;overflow:hidden;height:auto;position:relative;box-shadow:0 2px 1px -1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f;border-radius:3px;margin-bottom:24px}.responsive-row[_ngcontent-%COMP%] + .responsive-row[_ngcontent-%COMP%]{margin-top:24px}mat-paginator[_ngcontent-%COMP%]{margin-top:24px}}'],changeDetection:0})}}return t})();export{Rt as HarmoniaUniversalisComponent};
