import{a as pe}from"./chunk-DKP4YRJ3.js";import{a as de}from"./chunk-S6LU7EFX.js";import{k as me}from"./chunk-CWWPZGSV.js";import"./chunk-2DG3KHRH.js";import{H as te,I as ie,L as ne,M as ae,b as N,f as z,i as G,k as H,r as Q,s as J,t as Y,u as Z}from"./chunk-7WEUQ37Z.js";import{A as q,Cb as b,Da as j,J as A,La as v,M as I,Ma as C,Na as B,Oa as w,Pa as L,Qa as p,Ra as i,Sa as a,Sb as $,T as h,Ta as x,W as T,X as y,_a as F,ab as E,ac as V,cb as d,fc as U,o as k,od as ee,pa as o,pd as oe,qb as c,qd as se,r as u,rb as S,rd as re,sb as g,tc as W,td as le,u as R,uc as K,vc as X,wd as ce,x as P,ya as O}from"./chunk-MW253N2G.js";var he=()=>[""],ue=()=>["/bibliography"],ge=()=>["/search"],fe=(t,s)=>s.id;function _e(t,s){if(t&1&&(i(0,"div",10),c(1),a()),t&2){let n=d();o(),g(" ",n.warningMessage," ")}}function ve(t,s){if(t&1&&(i(0,"span"),c(1),a()),t&2){let n=d().$implicit;o(),g(", ",n.description)}}function Ce(t,s){if(t&1){let n=F();i(0,"div")(1,"span",12),c(2),a(),i(3,"mat-icon-button",13),E("click",function(){let r=T(n).$implicit,l=d(2);return y(l.goToDisplay(r.id))}),i(4,"mat-icon",14),c(5,"open_in_new"),a()(),v(6,ve,2,1,"span"),x(7,"hr"),a()}if(t&2){let n=s.$implicit;o(2),g("",n.label,"\xA0"),o(2),p("inline",!0),o(2),C(n.description?6:-1)}}function xe(t,s){if(t&1&&(i(0,"div",9)(1,"div",11),w(2,Ce,8,3,"div",null,fe),a()()),t&2){let n=d();o(2),L(n.items)}}function Se(t,s){if(t&1){let n=F();i(0,"span",23),c(1),i(2,"mat-icon-button",13),E("click",function(){T(n);let r=d().$implicit,l=d(2);return y(l.goToDisplay(r.value.id))}),i(3,"mat-icon",24),c(4,"open_in_new"),a()()()}if(t&2){let n=d().$implicit;o(),g(" ",n.label,"\xA0 "),o(2),p("inline",!0)}}function be(t,s){if(t&1&&(i(0,"div",22),v(1,Se,5,2,"span",23),x(2,"br"),a()),t&2){let n=s.$implicit;o(),C(n?1:-1)}}function Me(t,s){if(t&1&&(i(0,"div")(1,"div",15)(2,"a",16),c(3),a(),i(4,"span"),c(5,"\xA0|\xA0"),a(),i(6,"a",16),c(7),a(),i(8,"span"),c(9,"\xA0|\xA0"),a(),i(10,"a",16),c(11,"FactGrid"),a(),i(12,"span"),c(13,"\xA0|\xA0"),a(),i(14,"a",17),c(15," Sparql query "),a()(),i(16,"div",18)(17,"mat-card",19)(18,"div",20),c(19),a(),i(20,"div",21),x(21,"hr"),i(22,"mat-card-content")(23,"div"),w(24,be,3,1,"div",22,B),a()()()()()()),t&2){let n=d();o(2),p("routerLink",b(6,he)),o(),S(n.home_page),o(3),p("routerLink",b(7,ue)),o(),S(n.bibliography),o(3),p("routerLink",b(8,ge)),o(9),S(n.formerVisitsTitle),o(5),L(n.selectedItemsList)}}function Ae(t,s){let n=[];for(let e=0;e<t.length;e+=s)n.push(t.slice(e,e+s));return n}var Ke=(()=>{let s=class s{constructor(){this.changeDetector=h($),this.request=h(oe),this.setLanguage=h(de),this.lang=h(se),this.lastSearchRoute=h(pe),this.router=h(W),this.prosopography="Prosopography Harmonia Universalis",this.animalMagnetism_subtitle="a database on animal magnetism",this.subTitle="a database on animal magnetism",this.advanced_search="advanced search",this.projects="research projects",this.fields="fields of reserach",this.warningMessage="",this.searchInput=new G,this.isDisplay=!1,this.items=[],this.selectedItemsList=JSON.parse(localStorage.getItem("selectedItems"))||[]}goToDisplay(e){this.lastSearchRoute.setLastSearchRoute(this.router.url),console.log("Route m\xE9moris\xE9e :",this.router.url),this.router.navigate(["/item",e])}ngOnInit(){this.animalMagnetism_subtitle=this.lang.getTranslation("home_subtitle",this.lang.selectedLang),console.log("Sous-titre:",this.animalMagnetism_subtitle),this.subTitle=this.lang.getTranslation("subTitle",this.lang.selectedLang),this.home_page=this.lang.getTranslation("home_page",this.lang.selectedLang),this.advanced_search=this.lang.getTranslation("advanced_search",this.lang.selectedLang),this.projects=this.lang.getTranslation("projects",this.lang.selectedLang),this.fields=this.lang.getTranslation("fields",this.lang.selectedLang),this.bibliography=this.lang.getTranslation("bibliography",this.lang.selectedLang),this.selectedItemsList=this.selectedItemsList.filter(e=>e!==null),this.pages=this.request.getStat().pipe(u(e=>Object.values(e)[1].statistics.pages)),this.labels=this.searchInput.valueChanges.pipe(q(250),I(e=>{(!e||e.length===0)&&(this.items=[],this.isDisplay=!1,this.changeDetector.detectChanges())}),A(e=>{let r=e.endsWith("*")?e:e+"*",l=`https://database.factgrid.de/w/api.php?action=query&list=search&format=json&origin=*&srsearch=haswbstatement:P131=Q99677${r?" "+r:""}&srnamespace=120&srlimit=200`;return this.request.getItem(l).pipe(I(m=>console.log("R\xE9ponse CirrusSearch:",m)))}),u(e=>{if(!e.query||!e.query.search)return[];let r=e.query.search.map(l=>{let m=l.title.match(/Q\d+/);return m?m[0]:null}).filter(l=>!!l);return console.log("Q-ids extraits:",r),r}),P(e=>e.length>0),A(e=>{let r=this.lang.selectedLang,m=Ae(e,50).map(f=>{let _=`https://database.factgrid.de/w/api.php?action=wbgetentities&ids=${f.join("|")}&format=json&languages=${r}&origin=*`;return this.request.getItem(_).pipe(u(M=>M&&M.entities?Object.values(M.entities):[]))});return m.length>0?R(m).pipe(u(f=>f.flat())):k([])}),u(e=>{let r=(this.searchInput.value||"").toLowerCase(),l=this.lang.selectedLang;return e.filter(m=>{let f=m.labels?.[l]?.value?.toLowerCase()||"",D=(m.aliases?.[l]||[]).map(_=>_.value.toLowerCase());return r===""||f.includes(r)||D.some(_=>_.includes(r))})})).subscribe(e=>{this.items=this.setLanguage.item(e,this.lang.selectedLang),this.isDisplay=this.items.length>0,this.changeDetector.detectChanges()})}ngOnDestroy(){this.labels&&this.labels.unsubscribe()}};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=O({type:s,selectors:[["app-animal-magnetism"]],decls:16,vars:5,consts:[[1,"cardBackground"],[1,"prosopo-header"],[1,"prosopo-title"],[1,"prosopo-subtitle"],["appearance","outlined",1,"mat-elevation-z12"],[1,"search-center2"],["matInput","","placeholder","Ex. Goethe","value","Goethe",3,"formControl"],["class","warning",4,"ngIf"],[1,"search-center"],[1,"searchListSize"],[1,"warning"],[1,"details"],[1,"search-label"],["type","button",1,"internalLink",3,"click"],["color","primary",3,"inline"],[1,"search-center","router-links"],[3,"routerLink"],["href","https://database.factgrid.de/query/#%23model%0A%0ASELECT%20%3Fitem%20%3Fviewer%20%3FitemLabel%20%20WHERE%20%7B%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22.%20%7D%0A%20%20%3Fitem%20wdt%3AP2%20wd%3AQ7%3B%0A%20%20%20%20%20%20%20%20wdt%3AP247%20wd%3AQ24708.%0A%20%20BIND%28STRAFTER%28STR%28%3Fitem%29%2C%20STR%28wd%3A%29%29%20AS%20%3FitemId%29%0A%20%20BIND%28IRI%28CONCAT%28%22https%3A%2F%2Fdatabase.factgrid.de%2Fviewer%2Fitem%2F%22%2C%20%3FitemId%29%29%20AS%20%3Fviewer%29%0A%7D%0A"],[1,"search-itemSelected"],["appearance","outlined",1,"search-itemSelected-mat-card"],[1,"selectedListTitle2"],[1,"selectedItemSize"],[1,"labelTitlePadding"],[1,"selectedItemText"],[1,"whiteButton",3,"inline"]],template:function(r,l){r&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),c(3," Harmonia Universalis "),a(),i(4,"div",3),c(5),a()(),i(6,"mat-card",4)(7,"mat-card-content")(8,"div")(9,"div",5)(10,"mat-form-field"),x(11,"input",6),a(),j(12,_e,2,1,"div",7),a()()(),i(13,"div",8),v(14,xe,4,0,"div",9),v(15,Me,26,9,"div"),a()()()),r&2&&(o(5),g(" ",l.animalMagnetism_subtitle," "),o(6),p("formControl",l.searchInput),o(),p("ngIf",l.warningMessage),o(2),C(l.isDisplay==!0?14:-1),o(),C(l.isDisplay==!1?15:-1))},dependencies:[U,V,X,K,J,N,z,H,Q,ae,ne,te,ie,me,Z,Y,ee,ce,re,le],styles:[".search-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.HU-div[_ngcontent-%COMP%]{height:150px;display:flex;align-items:center;justify-content:center}.HUTitle-div[_ngcontent-%COMP%]{padding-left:10px;color:#ad1457;font-weight:600;font-size:60px}.search-label[_ngcontent-%COMP%]{font-weight:700}.search-itemSelected[_ngcontent-%COMP%]{margin-top:50px}.selectedItemSize[_ngcontent-%COMP%]{font-size:14px}"]});let t=s;return t})();export{Ke as AnimalMagnetismComponent};
