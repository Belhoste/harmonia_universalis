import{a as s,b as c}from"./chunk-U3RDBIDU.js";import{S as u,W as i,k as r,s as o}from"./chunk-6FH7UK33.js";var m=(()=>{class l{constructor(){this.request=i(s),this.lang=i(c),this.biblioData$=new r(null),this.myLang="%20.%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22"+this.lang.selectedLang+"%22%2C%22en%22.%20%7D%0A%7D%0A"}sparqlBuilding(e){return"https://database.factgrid.de/query/#%23biblio%0ASELECT%20DISTINCT%20%3Ftitle%20%3FtitleLabel%20%3Fauthor%20%3FauthorLabel%20%3Fdate%20%3Flocation%20%3FlocationLabel%20%3Fcountry%20%3FcountryLabel%0AWHERE%20%0A%7B%20VALUES%20%3Fc%20%7B%20wd%3AQ21925%20wd%3AQ11317%20%7D%0A%20%20%3Ftitle%20wdt%3AP2%20wd%3AQ20%3B%0A%20%20%20%20%20%20%20%20wdt%3AP243%20wd%3AQ172203%3B%0A%20%20%20%20%20%20%20%20wdt%3AP21%20%3Fauthor%3B%0A%20%20%20%20%20%20%20%20wdt%3AP222%20%3Fdate%3B%0A%20%20%20%20%20%20%20%20wdt%3AP241%20%3Flocation%20.%0A%20%20%3Fcountry%20%5Ewdt%3AP297%20%3Flocation%3B%0A%20%20%20%20%20%20%20%20%20%20wdt%3AP2%20%20%20%3Fc%20%20"+e}listFromSparql(e){if(e?.results?.bindings){let a=e.results.bindings.map(t=>({author:t.author?{id:t.author.value.replace("https://database.factgrid.de/entity/",""),label:t.authorLabel?.value??""}:void 0,title:t.title?{id:t.title.value.replace("https://database.factgrid.de/entity/",""),label:t.titleLabel?.value??""}:void 0,location:t.location?{id:t.location.value.replace("https://database.factgrid.de/entity/",""),label:t.locationLabel?.value??""}:void 0,country:t.country?{id:t.country.value.replace("https://database.factgrid.de/entity/",""),label:t.countryLabel?.value??""}:void 0,date:t.date?.value?{value:t.date.value.slice(0,4)}:{value:""}}));return e.results.bindings=[],a}return[]}databaseToDisplay(e){return this.request.getList(e).pipe(o(a=>this.listFromSparql(a)))}loadBiblioData(e){this.databaseToDisplay(e).subscribe({next:a=>this.biblioData$.next(a),error:a=>console.error("Erreur lors du chargement des donn\xE9es",a)})}getBiblioData(){return this.biblioData$.asObservable()}newSparqlAdress(e){let a="https://database.factgrid.de/sparql?query=",t="https://database.factgrid.de/query/#";return e.includes("embed.html")&&(t="https://database.factgrid.de/query/embed.html#"),e!==void 0&&(e=e.replace(t,a)),e}databaseToDownload(e){let a=[["author","author.id","title","title.id","location","location.id","country","country.id","date"]];for(let t=0;t<e.length;t++)a[t+1]=[e[t].author.label,e[t].author.id,e[t].title.label,e[t].title.id,e[t].location.label,e[t].location.id,e[t].country.label,e[t].country.id,e[t].date.value];return a}initBiblioData(e){(!this.biblioData$.getValue()||this.biblioData$.getValue().length===0)&&this.loadBiblioData(e)}static{this.\u0275fac=function(a){return new(a||l)}}static{this.\u0275prov=u({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();export{m as a};
