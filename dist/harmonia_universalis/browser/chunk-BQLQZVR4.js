import{a as at}from"./chunk-6EOGRMCZ.js";import{a as D,b as wt,c as Mt,d as A,e as Ft}from"./chunk-B6BDG3CK.js";import{e as Pt,f as Ot}from"./chunk-LWF7AYMT.js";import{a as bt}from"./chunk-6NO57R5M.js";import{f as vt,g as St}from"./chunk-5UZHVRYG.js";import{a as rt,b as lt,c as st,d as pt,e as ct,f as mt,g as dt,h as _t,i as ut,j as gt,k as ft,l as ht}from"./chunk-7SWT5MIX.js";import{$ as yt,I as K,J as X,Y as Ct,_ as xt}from"./chunk-XPHXKHTR.js";import{b as ot}from"./chunk-U3RDBIDU.js";import{$a as N,Ad as nt,Cb as G,Db as b,Ka as u,Oa as Q,Pa as d,Ua as g,Va as P,W as M,Wa as O,Xa as F,Ya as a,Z as j,Za as i,_a as E,ab as q,cb as T,ea as h,fa as C,fb as x,hb as c,k as B,nb as I,nd as W,ob as $,pb as V,rc as J,s as R,sc as U,sd as Y,t as H,tb as p,td as Z,ub as k,ud as tt,vb as f,vd as et,xa as o,xd as it}from"./chunk-6FH7UK33.js";var Tt=()=>[""],kt=()=>["/harmonia_universalis"],Dt=()=>["/search"],At=()=>[];function Lt(e,l){if(e&1&&(a(0,"mat-option",16),p(1),i()),e&2){let t=l.$implicit;d("value",t),o(),k(t)}}function zt(e,l){if(e&1&&(a(0,"mat-icon"),p(1),i()),e&2){let t=c(4);o(),f(" ",(t.sort==null?null:t.sort.direction)==="asc"?"arrow_upward":"arrow_downward"," ")}}function It(e,l){if(e&1){let t=T();a(0,"button",23),x("click",function(){h(t);let s=c().$implicit,n=c(2);return C(n.setSort(s))}),p(1),u(2,zt,2,1,"mat-icon"),i()}if(e&2){let t=c().$implicit,r=c(2);d("color",(r.sort==null?null:r.sort.active)===t?"primary":""),o(),f(" ",r.getHeaderLabel(t)," "),o(),g((r.sort==null?null:r.sort.active)===t?2:-1)}}function $t(e,l){if(e&1&&u(0,It,3,3,"button",22),e&2){let t=l.$implicit;g(t==="label"?0:-1)}}function Vt(e,l){if(e&1&&(a(0,"div",17),O(1,$t,1,1,null,null,P),i()),e&2){let t=c();o(),F(t.displayedColumns)}}function Bt(e,l){e&1&&E(0,"mat-progress-spinner",18)}function Rt(e,l){if(e&1&&(a(0,"th",31),p(1),i()),e&2){let t=c().$implicit,r=c(2);o(),f(" ",r.getHeaderLabel(t)," ")}}function Ht(e,l){if(e&1&&(a(0,"button",35)(1,"mat-icon",36),p(2,"open_in_new"),i()()),e&2){let t=c(3).$implicit;d("routerLink","/item/"+t.person.id),o(),d("inline",!0)}}function jt(e,l){if(e&1&&(a(0,"span",33)(1,"span"),p(2),i(),u(3,Ht,3,2,"button",35),i()),e&2){let t=c(2).$implicit;o(2),k(t.person.label),o(),g(t.person.id?3:-1)}}function Qt(e,l){e&1&&(a(0,"span",34),p(1,"[Inconnu]"),i())}function Nt(e,l){if(e&1&&u(0,jt,4,2,"span",33)(1,Qt,2,0,"span",34),e&2){let t=c().$implicit;g(t.person?0:1)}}function qt(e,l){if(e&1&&p(0),e&2){let t=c(2).$implicit;f(" ",t.person.description," ")}}function Gt(e,l){e&1&&(a(0,"span",34),p(1,"[Aucune]"),i())}function Jt(e,l){if(e&1&&u(0,qt,1,1)(1,Gt,2,0,"span",34),e&2){let t=c().$implicit;g(t.person?0:1)}}function Ut(e,l){if(e&1&&(a(0,"button",37)(1,"mat-icon",36),p(2,"open_in_new"),i()()),e&2){let t=c(3).$implicit;d("routerLink","/item/"+t.society.id),o(),d("inline",!0)}}function Wt(e,l){if(e&1&&(a(0,"span"),p(1),u(2,Ut,3,2,"button",37),i()),e&2){let t=c(2).$implicit;o(),f(" ",t.society.label," "),o(),g(t.society.id?2:-1)}}function Kt(e,l){e&1&&(a(0,"span",34),p(1,"[Aucune]"),i())}function Xt(e,l){if(e&1&&u(0,Wt,3,2,"span")(1,Kt,2,0,"span",34),e&2){let t=c().$implicit;g(t.society?0:1)}}function Yt(e,l){if(e&1&&(a(0,"span"),p(1),i()),e&2){let t=c().$implicit,r=c().$implicit;o(),k(t[r])}}function Zt(e,l){if(e&1&&(a(0,"td",32),u(1,Nt,2,1)(2,Jt,2,1)(3,Xt,2,1)(4,Yt,2,1,"span"),i()),e&2){let t,r=c().$implicit,s=c(2);Q("data-label",s.getHeaderLabel(r)),o(),g((t=r)==="label"?1:t==="description"?2:t==="society"?3:4)}}function te(e,l){if(e&1&&(N(0,25),u(1,Rt,2,1,"th",29)(2,Zt,5,2,"td",30),q()),e&2){let t=l.$implicit;d("matColumnDef",t)}}function ee(e,l){e&1&&E(0,"tr",38)}function ie(e,l){e&1&&E(0,"tr",39)}function ne(e,l){if(e&1){let t=T();a(0,"div",19)(1,"table",24),O(2,te,3,1,"ng-container",25,P),u(4,ee,1,0,"tr",26)(5,ie,1,0,"tr",27),i(),a(6,"mat-paginator",28,1),x("page",function(s){h(t);let n=c();return C(n.handlePageEvent(s))}),i()()}if(e&2){let t=c();o(),d("dataSource",t.dataSource),o(),F(t.displayedColumns),o(2),d("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),o(),d("matRowDefColumns",t.displayedColumns),o(),d("length",t.length)("pageSize",t.pageSize)("disabled",t.disabled)("showFirstLastButtons",t.showFirstLastButtons)("pageSizeOptions",t.showPageSizeOptions?t.pageSizeOptions:b(11,At))("hidePageSize",t.hidePageSize)("pageIndex",t.pageIndex)}}var Et={label:e=>e.person?.label,description:e=>e.person?.description,society:e=>e.society?.label,name:e=>e.name?.label},ze=(()=>{class e{constructor(){this.database=M(at),this.lang=M(ot),this.csv=M(bt),this.prosopography="Prosopography Harmonia Universalis",this.displayedColumns=["label","description"],this.dataSource=new ht,this.behavior$=new B(""),this.length=50,this.pageSize=25,this.pageIndex=0,this.pageSizeOptions=[10,25,50,100,500,1e3],this.hidePageSize=!1,this.showPageSizeOptions=!0,this.showFirstLastButtons=!0,this.disabled=!1,this.generalFilter="",this.nameFilter="",this.societyFilter="",this.isMobile=window.innerWidth<=600,this.societyOptions=[],this.selectedSociety="",this.isSpinner=!0,this.myLang="%20.%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22"+this.lang.selectedLang+"%22%2C%22en%22.%20%7D%0A%7D%0A"}getHeaderLabel(t){switch(t){case"label":return"Nom";case"description":return"Description";case"society":return"Soci\xE9t\xE9";default:return t}}ngOnInit(){window.addEventListener("resize",()=>{this.isMobile=window.innerWidth<=600}),this.dataSource.filterPredicate=(n,m)=>{let _=JSON.parse(m),y=_.general,v=_.name,S=_.society,L=(n.person?.label?.toLowerCase().includes(y)??!1)||(n.person?.description?.toLowerCase().includes(y)??!1),z=n.name?.label?n.name.label.toLowerCase().includes(v):!1,w=!S||n.society?.label===S;return L&&(v===""||z)&&w},this.dataSource.sortingDataAccessor=(n,m)=>Et[m]?Et[m](n)||"":typeof n[m]=="string"?n[m]:"",this.dataSource.sortData=(n,m)=>{let _=m.active,y=m.direction;return!_||y===""?n:n.slice().sort((v,S)=>{let L=this.dataSource.sortingDataAccessor(v,_),z=this.dataSource.sortingDataAccessor(S,_),w=L.localeCompare(z,"fr",{sensitivity:"base"});return y==="asc"?w:-w})};let t=this.database.sparqlBuilding(this.myLang),r=this.database.newSparqlAdress(t);this.database.initProsopoData(r);let s=this.database.getProsopoData();this.dataSource$=H([this.behavior$,s]).pipe(R(n=>(this.dataSource.filter=n[0],this.dataSource.data=n[1],this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,console.log(this.dataSource.data),this.dataSource))),this.dataSource$.subscribe(n=>{this.isSpinner=!1,this.societyOptions=Array.from(new Set(this.dataSource.data.map(m=>m.society?.label).filter(m=>!!m)))})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}onClick(t){let r=t;r=this.database.databaseToDownload(t);let s=this.csv.arrayToCsv(r);this.csv.downloadBlob(s,"_prosopo_harmonia_universalis","text/csv;charset=utf-8;")}applyGeneralFilter(t){this.generalFilter=t.target.value.trim().toLowerCase(),this.applyCombinedFilter()}applyNameFilter(t){this.nameFilter=t.target.value.trim().toLowerCase(),this.applyCombinedFilter()}applyCombinedFilter(){this.dataSource.filter=JSON.stringify({general:this.generalFilter,name:this.nameFilter,society:this.societyFilter})}applySocietyFilter(t){this.societyFilter=t,this.applyCombinedFilter()}handlePageEvent(t){this.pageEvent=t,this.length=t.length,this.pageSize=t.pageSize,this.pageIndex=t.pageIndex}setSort(t){this.sort.active===t?this.sort.direction=this.sort.direction==="asc"?"desc":"asc":(this.sort.active=t,this.sort.direction="asc"),this.sort.sortChange.emit({active:this.sort.active,direction:this.sort.direction})}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=j({type:e,selectors:[["phy"]],viewQuery:function(r,s){if(r&1&&(I(D,5),I(A,5)),r&2){let n;$(n=V())&&(s.sort=n.first),$(n=V())&&(s.paginator=n.first)}},standalone:!0,features:[G],decls:43,vars:12,consts:[["content",""],["paginator",""],[1,"cardBackground"],[1,"prosopo-header"],[1,"prosopo-title"],[1,"search-center"],[3,"routerLink"],["appearance","outlined",1,"mat-elevation-z12"],[1,"labelTitlePadding","filter-bar"],[1,"filter-left"],["appearance","outline"],["matInput","","placeholder","Recherchez",3,"keyup"],[1,"filter-right"],["matInput","","placeholder","Filtrez par nom",3,"keyup"],["placeholder","Filtrez par soci\xE9t\xE9",3,"selectionChange"],["value",""],[1,"styling-option",3,"value"],[1,"mobile-sort-buttons"],["mode","indeterminate","color","primary","diameter","50",2,"margin","2rem auto","display","block"],[1,"mat-elevation-z8","container"],["mat-icon-button","","color","primary",1,"internalLink",3,"click"],["color","primary",3,"inline"],["mat-button","",1,"sort-btn",3,"color"],["mat-button","",1,"sort-btn",3,"click","color"],["mat-table","","matSort","","matSortActive","label","matSortDirection","asc",1,"mat-table",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","","class","mat-header-row",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","responsive-row",4,"matRowDef","matRowDefColumns"],["aria-label","Select page",1,"demo-paginator",3,"page","length","pageSize","disabled","showFirstLastButtons","pageSizeOptions","hidePageSize","pageIndex"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","responsive-cell",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"responsive-cell"],[1,"label-with-icon"],[1,"text-muted"],["mat-icon-button","","matTooltip","Voir la personne dans la base de donn\xE9es",1,"compact-icon-btn",3,"routerLink"],["color","primary",1,"small-icon",3,"inline"],["mat-icon-button","","matTooltip","Voir la soci\xE9t\xE9 dans la base de donn\xE9es",1,"compact-icon-btn",3,"routerLink"],["mat-header-row","",1,"mat-header-row"],["mat-row","",1,"responsive-row"]],template:function(r,s){if(r&1){let n=T();a(0,"body")(1,"div",2)(2,"div",3)(3,"div",4),p(4),i(),a(5,"div",5)(6,"a",6),p(7,"Accueil"),i(),a(8,"span"),p(9,"\xA0|\xA0"),i(),a(10,"a",6),p(11,"Bibliography"),i(),a(12,"span"),p(13,"\xA0|\xA0"),i(),a(14,"a",6),p(15,"FactGrid"),i()()()(),a(16,"mat-card",7)(17,"mat-card-content",2)(18,"div",8)(19,"div",9)(20,"mat-form-field",10)(21,"input",11),x("keyup",function(_){return h(n),C(s.applyGeneralFilter(_))}),i()()(),a(22,"div",12)(23,"mat-form-field",10)(24,"input",13),x("keyup",function(_){return h(n),C(s.applyNameFilter(_))}),i()(),a(25,"mat-form-field",10)(26,"mat-select",14),x("selectionChange",function(_){return h(n),C(s.applySocietyFilter(_.value))}),a(27,"mat-option",15),p(28,"Aucun filtre de Soci\xE9t\xE9"),i(),O(29,Lt,2,2,"mat-option",16,P),i()()(),a(31,"div"),p(32),i()(),u(33,Vt,3,0,"div",17)(34,Bt,1,0,"mat-progress-spinner",18)(35,ne,8,12,"div",19),a(36,"div")(37,"span")(38,"button",20,0),x("click",function(){return h(n),C(s.onClick(s.dataSource.filteredData))}),a(40,"mat-icon",21),p(41,"download"),i()(),p(42," \xA0\xA0\xA0\xA0\xA0\xA0 "),i()()()()()}r&2&&(o(4),f(" ",s.prosopography," "),o(2),d("routerLink",b(9,Tt)),o(4),d("routerLink",b(10,kt)),o(4),d("routerLink",b(11,Dt)),o(15),F(s.societyOptions),o(3),f(" ",s.dataSource.filteredData.length," items "),o(),g(s.isMobile?33:-1),o(),g(s.isSpinner?34:-1),o(),g(s.isSpinner?-1:35),o(5),d("inline",!0))},dependencies:[nt,et,it,tt,Y,Z,X,K,ft,rt,st,dt,pt,lt,_t,ct,mt,ut,gt,Ot,Ct,Pt,W,Mt,D,wt,St,vt,Ft,A,yt,xt,U,J],styles:['.mat-elevation-z8.container[_ngcontent-%COMP%]{width:100%;overflow-x:auto}.filter-bar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px;border-radius:4px;padding:12px 16px;margin-bottom:16px;font-family:Oxygen,Arial,Helvetica,sans-serif}.filter-left[_ngcontent-%COMP%]{flex:1 1 auto;min-width:220px}.filter-right[_ngcontent-%COMP%]{display:flex;gap:16px;justify-content:flex-end;flex:1 1 auto}.filter-bar[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{min-width:180px;margin-bottom:0}.filter-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filter-bar[_ngcontent-%COMP%]   .mat-select-value[_ngcontent-%COMP%]{color:#222!important;font-family:Oxygen,Arial,Helvetica,sans-serif}.filter-bar[_ngcontent-%COMP%]   .mat-form-field-appearance-outline[_ngcontent-%COMP%]   .mat-form-field-outline[_ngcontent-%COMP%]{color:#bdbdbd;border-color:#bdbdbd}.filter-bar[_ngcontent-%COMP%]   .mat-form-field-appearance-outline[_ngcontent-%COMP%]   .mat-form-field-outline-thick[_ngcontent-%COMP%]{border-color:#3f51b5}.filter-bar[_ngcontent-%COMP%]   .mat-select-arrow[_ngcontent-%COMP%], .filter-bar[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:#222}.filter-count[_ngcontent-%COMP%]{flex-basis:100%;margin-top:8px;font-size:.95em;color:#666}.label-with-icon[_ngcontent-%COMP%]{display:inline-flex;align-items:center}@media (max-width: 600px){.filter-bar[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:8px}.filter-left[_ngcontent-%COMP%], .filter-right[_ngcontent-%COMP%]{flex:1 1 100%;min-width:0;width:100%;display:flex;flex-direction:column;gap:8px}.filter-right[_ngcontent-%COMP%]{justify-content:flex-start;align-items:stretch}.filter-bar[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%;min-width:0}.mat-header-row[_ngcontent-%COMP%]{display:none}}@media (max-width: 600px) and (max-width: 600px){.responsive-cell[_ngcontent-%COMP%]{display:flex!important;flex-direction:column;align-items:flex-start;justify-content:flex-start;width:100%;box-sizing:border-box;padding:4px 12px 12px!important;border:0 none!important;gap:2px;min-height:0!important;vertical-align:top!important}.responsive-cell[_ngcontent-%COMP%]:before{content:attr(data-label) ": ";font-weight:700;color:#666;white-space:nowrap;position:static;line-height:1.2;margin:0;padding:0}}@media (max-width: 600px){.responsive-row[_ngcontent-%COMP%]{display:block;overflow:hidden;height:auto;position:relative;box-shadow:0 2px 1px -1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f;border-radius:3px;margin-bottom:24px}.responsive-row[_ngcontent-%COMP%] + .responsive-row[_ngcontent-%COMP%]{margin-top:24px}mat-paginator[_ngcontent-%COMP%]{margin-top:24px}.mobile-sort-buttons[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;gap:2px;justify-content:center;margin-bottom:12px}.sort-btn[_ngcontent-%COMP%]{min-width:unset;padding:2px 6px;font-size:.95em;line-height:1.2;border:none;box-shadow:none;background:transparent}.sort-btn[_ngcontent-%COMP%]:focus{outline:none}.sort-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-left:2px;font-size:1em}}'],changeDetection:0})}}return e})();export{ze as ProsopographyComponent};
