import{a as oe}from"./chunk-PQJEVDGX.js";import{a as O,b as ve,c as we,d as E,e as Fe}from"./chunk-JJ5REURW.js";import{a as ye}from"./chunk-W4TGJWCA.js";import{e as Me,f as Pe}from"./chunk-PWUDSJ2V.js";import{f as be,g as Se}from"./chunk-5ZC2UETL.js";import{a as ae,b as re,c as le,d as se,e as pe,f as ce,g as me,h as de,i as _e,j as ue,k as fe,l as ge}from"./chunk-NDDQKOBX.js";import{$ as xe,I as W,J as X,Y as he,_ as Ce}from"./chunk-3CUYWVWG.js";import{b as ne}from"./chunk-3H76ELPW.js";import{$a as N,Ad as ie,Cb as G,Db as b,Ka as u,Oa as Q,Pa as d,Ua as f,Va as A,W as M,Wa as k,Xa as L,Ya as o,Z as j,Za as n,_a as P,ab as q,cb as z,ea as g,fa as h,fb as C,hb as m,k as V,nb as I,nd as K,ob as $,pb as R,rc as J,s as B,sc as U,t as H,tb as r,td as Y,ub as F,ud as Z,vb as x,vd as ee,xa as a,xd as te}from"./chunk-6NNPIAAU.js";var Ee=()=>[""],Te=()=>["/harmonia_universalis"],De=()=>["/search"],Ae=()=>[];function ke(t,l){if(t&1&&(o(0,"mat-option",16),r(1),n()),t&2){let e=l.$implicit;d("value",e),a(),F(e)}}function Le(t,l){t&1&&P(0,"mat-progress-spinner",17)}function ze(t,l){if(t&1&&(o(0,"th",28),r(1),n()),t&2){let e=m().$implicit,p=m(2);a(),x(" ",p.getHeaderLabel(e)," ")}}function Ie(t,l){if(t&1&&(o(0,"button",32)(1,"mat-icon",33),r(2,"open_in_new"),n()()),t&2){let e=m(3).$implicit;d("routerLink","/item/"+e.person.id),a(),d("inline",!0)}}function $e(t,l){if(t&1&&(o(0,"span",30)(1,"span"),r(2),n(),u(3,Ie,3,2,"button",32),n()),t&2){let e=m(2).$implicit;a(2),F(e.person.label),a(),f(e.person.id?3:-1)}}function Re(t,l){t&1&&(o(0,"span",31),r(1,"[Inconnu]"),n())}function Ve(t,l){if(t&1&&u(0,$e,4,2,"span",30)(1,Re,2,0,"span",31),t&2){let e=m().$implicit;f(e.person?0:1)}}function Be(t,l){if(t&1&&r(0),t&2){let e=m(2).$implicit;x(" ",e.person.description," ")}}function He(t,l){t&1&&(o(0,"span",31),r(1,"[Aucune]"),n())}function je(t,l){if(t&1&&u(0,Be,1,1)(1,He,2,0,"span",31),t&2){let e=m().$implicit;f(e.person?0:1)}}function Qe(t,l){if(t&1&&(o(0,"button",34)(1,"mat-icon",33),r(2,"open_in_new"),n()()),t&2){let e=m(3).$implicit;d("routerLink","/item/"+e.society.id),a(),d("inline",!0)}}function Ne(t,l){if(t&1&&(o(0,"span"),r(1),u(2,Qe,3,2,"button",34),n()),t&2){let e=m(2).$implicit;a(),x(" ",e.society.label," "),a(),f(e.society.id?2:-1)}}function qe(t,l){t&1&&(o(0,"span",31),r(1,"[Aucune]"),n())}function Ge(t,l){if(t&1&&u(0,Ne,3,2,"span")(1,qe,2,0,"span",31),t&2){let e=m().$implicit;f(e.society?0:1)}}function Je(t,l){if(t&1&&(o(0,"span"),r(1),n()),t&2){let e=m().$implicit,p=m().$implicit;a(),F(e[p])}}function Ue(t,l){if(t&1&&(o(0,"td",29),u(1,Ve,2,1)(2,je,2,1)(3,Ge,2,1)(4,Je,2,1,"span"),n()),t&2){let e,p=m().$implicit,s=m(2);Q("data-label",s.getHeaderLabel(p)),a(),f((e=p)==="label"?1:e==="description"?2:e==="society"?3:4)}}function Ke(t,l){if(t&1&&(N(0,22),u(1,ze,2,1,"th",26)(2,Ue,5,2,"td",27),q()),t&2){let e=l.$implicit;d("matColumnDef",e)}}function We(t,l){t&1&&P(0,"tr",35)}function Xe(t,l){t&1&&P(0,"tr",36)}function Ye(t,l){if(t&1){let e=z();o(0,"div",18)(1,"table",21),k(2,Ke,3,1,"ng-container",22,A),u(4,We,1,0,"tr",23)(5,Xe,1,0,"tr",24),n(),o(6,"mat-paginator",25,1),C("page",function(s){g(e);let i=m();return h(i.handlePageEvent(s))}),n()()}if(t&2){let e=m();a(),d("dataSource",e.dataSource),a(),L(e.displayedColumns),a(2),d("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),a(),d("matRowDefColumns",e.displayedColumns),a(),d("length",e.length)("pageSize",e.pageSize)("disabled",e.disabled)("showFirstLastButtons",e.showFirstLastButtons)("pageSizeOptions",e.showPageSizeOptions?e.pageSizeOptions:b(11,Ae))("hidePageSize",e.hidePageSize)("pageIndex",e.pageIndex)}}var Oe={label:t=>t.person?.label,description:t=>t.person?.description,society:t=>t.society?.label,name:t=>t.name?.label},Et=(()=>{class t{constructor(){this.database=M(oe),this.lang=M(ne),this.csv=M(ye),this.prosopography="Prosopography Harmonia Universalis",this.displayedColumns=["label","description"],this.dataSource=new ge,this.behavior$=new V(""),this.length=50,this.pageSize=25,this.pageIndex=0,this.pageSizeOptions=[10,25,50,100,500,1e3],this.hidePageSize=!1,this.showPageSizeOptions=!0,this.showFirstLastButtons=!0,this.disabled=!1,this.generalFilter="",this.nameFilter="",this.societyFilter="",this.societyOptions=[],this.selectedSociety="",this.isSpinner=!0,this.myLang="%20.%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22"+this.lang.selectedLang+"%22%2C%22en%22.%20%7D%0A%7D%0A"}getHeaderLabel(e){switch(e){case"label":return"Nom";case"description":return"Description";case"society":return"Soci\xE9t\xE9";default:return e}}ngOnInit(){this.dataSource.filterPredicate=(i,c)=>{let _=JSON.parse(c),y=_.general,S=_.name,v=_.society,T=(i.person?.label?.toLowerCase().includes(y)??!1)||(i.person?.description?.toLowerCase().includes(y)??!1),D=i.name?.label?i.name.label.toLowerCase().includes(S):!1,w=!v||i.society?.label===v;return T&&(S===""||D)&&w},this.dataSource.sortingDataAccessor=(i,c)=>Oe[c]?Oe[c](i)||"":typeof i[c]=="string"?i[c]:"",this.dataSource.sortData=(i,c)=>{let _=c.active,y=c.direction;return!_||y===""?i:i.slice().sort((S,v)=>{let T=this.dataSource.sortingDataAccessor(S,_),D=this.dataSource.sortingDataAccessor(v,_),w=T.localeCompare(D,"fr",{sensitivity:"base"});return y==="asc"?w:-w})};let e=this.database.sparqlBuilding(this.myLang),p=this.database.newSparqlAdress(e);this.database.initProsopoData(p);let s=this.database.getProsopoData();this.dataSource$=H([this.behavior$,s]).pipe(B(i=>(this.dataSource.filter=i[0],this.dataSource.data=i[1],this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,console.log(this.dataSource.data),this.dataSource))),this.dataSource$.subscribe(i=>{this.isSpinner=!1,this.societyOptions=Array.from(new Set(this.dataSource.data.map(c=>c.society?.label).filter(c=>!!c)))})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}onClick(e){let p=e;p=this.database.databaseToDownload(e);let s=this.csv.arrayToCsv(p);this.csv.downloadBlob(s,"_prosopo_harmonia_universalis","text/csv;charset=utf-8;")}applyGeneralFilter(e){this.generalFilter=e.target.value.trim().toLowerCase(),this.applyCombinedFilter()}applyNameFilter(e){this.nameFilter=e.target.value.trim().toLowerCase(),this.applyCombinedFilter()}applyCombinedFilter(){this.dataSource.filter=JSON.stringify({general:this.generalFilter,name:this.nameFilter,society:this.societyFilter})}applySocietyFilter(e){this.societyFilter=e,this.applyCombinedFilter()}handlePageEvent(e){this.pageEvent=e,this.length=e.length,this.pageSize=e.pageSize,this.pageIndex=e.pageIndex}static{this.\u0275fac=function(p){return new(p||t)}}static{this.\u0275cmp=j({type:t,selectors:[["phy"]],viewQuery:function(p,s){if(p&1&&(I(O,5),I(E,5)),p&2){let i;$(i=R())&&(s.sort=i.first),$(i=R())&&(s.paginator=i.first)}},standalone:!0,features:[G],decls:42,vars:11,consts:[["content",""],["paginator",""],[1,"cardBackground"],[1,"prosopo-header"],[1,"prosopo-title"],[1,"search-center"],[3,"routerLink"],["appearance","outlined",1,"mat-elevation-z12"],[1,"labelTitlePadding","filter-bar"],[1,"filter-left"],["appearance","outline"],["matInput","","placeholder","Recherchez",3,"keyup"],[1,"filter-right"],["matInput","","placeholder","Filtrez par nom",3,"keyup"],["placeholder","Filtrez par soci\xE9t\xE9",3,"selectionChange"],["value",""],[1,"styling-option",3,"value"],["mode","indeterminate","color","primary","diameter","50",2,"margin","2rem auto","display","block"],[1,"mat-elevation-z8","container"],["mat-icon-button","","color","primary",1,"internalLink",3,"click"],["color","primary",3,"inline"],["mat-table","","matSort","","matSortActive","label","matSortDirection","asc",1,"mat-table",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","","class","mat-header-row",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","responsive-row",4,"matRowDef","matRowDefColumns"],["aria-label","Select page",1,"demo-paginator",3,"page","length","pageSize","disabled","showFirstLastButtons","pageSizeOptions","hidePageSize","pageIndex"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","responsive-cell",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"responsive-cell"],[1,"label-with-icon"],[1,"text-muted"],["mat-icon-button","","matTooltip","Voir la personne dans la base de donn\xE9es",1,"compact-icon-btn",3,"routerLink"],["color","primary",1,"small-icon",3,"inline"],["mat-icon-button","","matTooltip","Voir la soci\xE9t\xE9 dans la base de donn\xE9es",1,"compact-icon-btn",3,"routerLink"],["mat-header-row","",1,"mat-header-row"],["mat-row","",1,"responsive-row"]],template:function(p,s){if(p&1){let i=z();o(0,"body")(1,"div",2)(2,"div",3)(3,"div",4),r(4),n(),o(5,"div",5)(6,"a",6),r(7,"Accueil"),n(),o(8,"span"),r(9,"\xA0|\xA0"),n(),o(10,"a",6),r(11,"Bibliography"),n(),o(12,"span"),r(13,"\xA0|\xA0"),n(),o(14,"a",6),r(15,"FactGrid"),n()()()(),o(16,"mat-card",7)(17,"mat-card-content",2)(18,"div",8)(19,"div",9)(20,"mat-form-field",10)(21,"input",11),C("keyup",function(_){return g(i),h(s.applyGeneralFilter(_))}),n()()(),o(22,"div",12)(23,"mat-form-field",10)(24,"input",13),C("keyup",function(_){return g(i),h(s.applyNameFilter(_))}),n()(),o(25,"mat-form-field",10)(26,"mat-select",14),C("selectionChange",function(_){return g(i),h(s.applySocietyFilter(_.value))}),o(27,"mat-option",15),r(28,"Aucun filtre de Soci\xE9t\xE9"),n(),k(29,ke,2,2,"mat-option",16,A),n()()(),o(31,"div"),r(32),n()(),u(33,Le,1,0,"mat-progress-spinner",17)(34,Ye,8,12,"div",18),o(35,"div")(36,"span")(37,"button",19,0),C("click",function(){return g(i),h(s.onClick(s.dataSource.filteredData))}),o(39,"mat-icon",20),r(40,"download"),n()(),r(41," \xA0\xA0\xA0\xA0\xA0\xA0 "),n()()()()()}p&2&&(a(4),x(" ",s.prosopography," "),a(2),d("routerLink",b(8,Ee)),a(4),d("routerLink",b(9,Te)),a(4),d("routerLink",b(10,De)),a(15),L(s.societyOptions),a(3),x(" ",s.dataSource.filteredData.length," items "),a(),f(s.isSpinner?33:-1),a(),f(s.isSpinner?-1:34),a(5),d("inline",!0))},dependencies:[ie,ee,te,Z,Y,X,W,fe,ae,le,me,se,re,de,pe,ce,_e,ue,Pe,he,Me,K,we,O,ve,Se,be,Fe,E,xe,Ce,U,J],styles:['.mat-elevation-z8.container[_ngcontent-%COMP%]{width:100%;overflow-x:auto}.filter-bar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px;border-radius:4px;padding:12px 16px;margin-bottom:16px;font-family:Oxygen,Arial,Helvetica,sans-serif}.filter-left[_ngcontent-%COMP%]{flex:1 1 auto;min-width:220px}.filter-right[_ngcontent-%COMP%]{display:flex;gap:16px;justify-content:flex-end;flex:1 1 auto}.filter-bar[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{min-width:180px;margin-bottom:0}.filter-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filter-bar[_ngcontent-%COMP%]   .mat-select-value[_ngcontent-%COMP%]{color:#222!important;font-family:Oxygen,Arial,Helvetica,sans-serif}.filter-bar[_ngcontent-%COMP%]   .mat-form-field-appearance-outline[_ngcontent-%COMP%]   .mat-form-field-outline[_ngcontent-%COMP%]{color:#bdbdbd;border-color:#bdbdbd}.filter-bar[_ngcontent-%COMP%]   .mat-form-field-appearance-outline[_ngcontent-%COMP%]   .mat-form-field-outline-thick[_ngcontent-%COMP%]{border-color:#3f51b5}.filter-bar[_ngcontent-%COMP%]   .mat-select-arrow[_ngcontent-%COMP%], .filter-bar[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:#222}.filter-count[_ngcontent-%COMP%]{flex-basis:100%;margin-top:8px;font-size:.95em;color:#666}.label-with-icon[_ngcontent-%COMP%]{display:inline-flex;align-items:center}@media (max-width: 600px){.filter-bar[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:8px}.filter-left[_ngcontent-%COMP%], .filter-right[_ngcontent-%COMP%]{flex:1 1 100%;min-width:0;width:100%;display:flex;flex-direction:column;gap:8px}.filter-right[_ngcontent-%COMP%]{justify-content:flex-start;align-items:stretch}.filter-bar[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%;min-width:0}.mat-header-row[_ngcontent-%COMP%]{display:none}}@media (max-width: 600px) and (max-width: 600px){.responsive-cell[_ngcontent-%COMP%]{display:flex!important;flex-direction:column;align-items:flex-start;justify-content:flex-start;width:100%;box-sizing:border-box;padding:4px 12px 12px!important;border:0 none!important;gap:2px;min-height:0!important;vertical-align:top!important}.responsive-cell[_ngcontent-%COMP%]:before{content:attr(data-label) ": ";font-weight:700;color:#666;white-space:nowrap;position:static;line-height:1.2;margin:0;padding:0}}@media (max-width: 600px){.responsive-row[_ngcontent-%COMP%]{display:block;overflow:hidden;height:auto;position:relative;box-shadow:0 2px 1px -1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f;border-radius:3px;margin-bottom:24px}.responsive-row[_ngcontent-%COMP%] + .responsive-row[_ngcontent-%COMP%]{margin-top:24px}mat-paginator[_ngcontent-%COMP%]{margin-top:24px}}']})}}return t})();export{Et as ProsopographyComponent};
