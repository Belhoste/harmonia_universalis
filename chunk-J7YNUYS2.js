import{P as d,T as o,k as u,pd as s,qd as c,r as n}from"./chunk-A4ZR74WL.js";var F=(()=>{let l=class l{constructor(){this.request=o(s),this.lang=o(c),this.biblioData$=new u(null),this.myLang="%20.%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22"+this.lang.selectedLang+"%22%2C%22en%22.%20%7D%0A%7D%0A"}sparqlBuilding(t,e,a){let r="https://database.factgrid.de/query/#%23biblio%0ASELECT%20DISTINCT%20%3Ftitle%20%3FtitleLabel%20%3Fauthor%20%3FauthorLabel%20%3Fdate%20%3Flocation%20%3FlocationLabel%20%3Fcountry%20%3FcountryLabel%0AWHERE%20%0A%7B%20VALUES%20%3Fc%20%7B%20wd%3AQ21925%20wd%3AQ11317%20%7D%0A%20%20%3Ftitle%20wdt%3AP2%20wd%3AQ20%3B%0A%20%20%20%20%20%20%20%20wdt%3AP243%20wd%3AQ172203%3B%0A%20%20%20%20%20%20%20%20wdt%3AP21%20%3Fauthor%3B%0A%20%20%20%20%20%20%20%20wdt%3AP222%20%3Fdate%3B%0A%20%20%20%20%20%20%20%20wdt%3AP241%20%3Flocation%20.%0A%20%20%3Fcountry%20%5Ewdt%3AP297%20%3Flocation%3B%0A%20%20%20%20%20%20%20%20%20%20wdt%3AP2%20%20%20%3Fc%20%20"+t;return e!==void 0&&(r+=` LIMIT ${e}`),a!==void 0&&a>0&&(r+=` OFFSET ${a}`),r}updateBiblioData(t){this.biblioData$.next(t)}listFromSparql(t){return t?.results?.bindings?t.results.bindings.map(e=>({author:e.author?{id:e.author.value.replace("https://database.factgrid.de/entity/",""),label:e.authorLabel?.value||""}:void 0,title:e.title?{id:e.title.value.replace("https://database.factgrid.de/entity/",""),label:e.titleLabel?.value||""}:void 0,location:e.location?{id:e.location.value.replace("https://database.factgrid.de/entity/",""),label:e.locationLabel?.value||""}:void 0,country:e.country?{id:e.country.value.replace("https://database.factgrid.de/entity/",""),label:e.countryLabel?.value||""}:void 0,date:{value:e.date?.value?e.date.value.slice(0,4):""}})):[]}databaseToDisplay(t){return this.request.getList(t).pipe(n(e=>this.listFromSparql(e)))}loadBiblioData(t){this.databaseToDisplay(t).subscribe({next:e=>this.biblioData$.next(e),error:e=>console.error("Erreur lors du chargement des donn\xE9es",e)})}getBiblioData(){return this.biblioData$.asObservable()}getCurrentData(){return this.biblioData$.getValue()}newSparqlAdress(t){let e="https://database.factgrid.de/sparql?query=",a="https://database.factgrid.de/query/#";return t.includes("embed.html")&&(a="https://database.factgrid.de/query/embed.html#"),t!==void 0&&(t=t.replace(a,e)),t}databaseToDownload(t){let e=[["author","author.id","title","title.id","location","location.id","country","country.id","date"]];for(let a=0;a<t.length;a++)e[a+1]=[t[a].author.label,t[a].author.id,t[a].title.label,t[a].title.id,t[a].location.label,t[a].location.id,t[a].country.label,t[a].country.id,t[a].date.value];return e}initBiblioData(t){(!this.biblioData$.getValue()||this.biblioData$.getValue().length===0)&&this.loadBiblioData(t)}};l.\u0275fac=function(e){return new(e||l)},l.\u0275prov=d({token:l,factory:l.\u0275fac,providedIn:"root"});let i=l;return i})();export{F as a};
