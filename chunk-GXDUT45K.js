import{a as Ft}from"./chunk-RMXYEF4O.js";import{a as rt}from"./chunk-X74DPJB7.js";import{a as y,b as Ht,c as Tt,d as Ot,e as Ut}from"./chunk-B6BDG3CK.js";import{g as Pt,h as Dt}from"./chunk-LWF7AYMT.js";import{a as wt}from"./chunk-6NO57R5M.js";import{f as Mt,g as yt}from"./chunk-5UZHVRYG.js";import{a as lt,b as st,c as ct,d as mt,e as dt,f as pt,g as _t,h as ut,i as ht,j as ft,k as gt,l as Ct}from"./chunk-7SWT5MIX.js";import{$ as St,I as X,J as Y,Y as xt,Z as vt,_ as bt,r as N,s as W}from"./chunk-XPHXKHTR.js";import{b as ot}from"./chunk-U3RDBIDU.js";import{$a as R,Ad as at,Cb as V,Db as S,Ka as p,Oa as z,Pa as d,Ua as u,Va as A,Vc as K,W as g,Wa as L,Xa as $,Ya as a,Yb as Q,Z as E,Za as o,Zb as j,_a as v,ab as B,cb as w,cc as q,ea as C,fa as x,fb as b,hb as s,k as O,nb as H,ob as T,pb as F,rc as G,s as U,sc as J,sd as Z,t as k,tb as c,td as tt,ub as M,ud as et,vb as h,vd as it,wa as I,xa as n,xd as nt}from"./chunk-6FH7UK33.js";var Lt=["paginator"],$t=()=>[""],Rt=()=>["/prosopography"],Bt=()=>["/search"],Vt=()=>[];function Qt(e,r){if(e&1&&(a(0,"mat-icon"),c(1),o()),e&2){let t=s(3);n(),h(" ",(t.sort==null?null:t.sort.direction)==="asc"?"arrow_upward":"arrow_downward"," ")}}function jt(e,r){if(e&1){let t=w();a(0,"button",19),b("click",function(){let m=C(t).$implicit,l=s(2);return x(l.setSort(m))}),c(1),p(2,Qt,2,1,"mat-icon",20),o()}if(e&2){let t=r.$implicit,i=s(2);d("color",(i.sort==null?null:i.sort.active)===t?"primary":void 0),n(),h(" ",i.getHeaderLabel(t)," "),n(),d("ngIf",(i.sort==null?null:i.sort.active)===t)}}function qt(e,r){if(e&1&&(a(0,"div",17),p(1,jt,3,3,"button",18),o()),e&2){let t=s();n(),d("ngForOf",t.displayedColumns)}}function Nt(e,r){e&1&&v(0,"mat-progress-spinner",13)}function Wt(e,r){if(e&1&&(a(0,"th",28),c(1),o()),e&2){let t=s().$implicit,i=s(2);n(),h(" ",i.getHeaderLabel(t)," ")}}function Gt(e,r){if(e&1&&c(0),e&2){let t=s(2).$implicit;h(" ",t.author.label," ")}}function Jt(e,r){e&1&&(a(0,"span",30),c(1,"[Inconnu]"),o())}function Kt(e,r){if(e&1&&(a(0,"button",31)(1,"mat-icon",32),c(2,"open_in_new"),o()()),e&2){let t=s(2).$implicit;d("routerLink","/item/"+t.author.id),n(),d("inline",!0)}}function Xt(e,r){if(e&1&&p(0,Gt,1,1)(1,Jt,2,0,"span",30)(2,Kt,3,2,"button",31),e&2){let t=s().$implicit;u(t.author?0:1),n(2),u(t.author!=null&&t.author.id?2:-1)}}function Yt(e,r){if(e&1&&(a(0,"span"),c(1),o()),e&2){let t=s().$implicit;n(),M(t.title.label)}}function Zt(e,r){if(e&1&&c(0),e&2){let t=s(2).$implicit;h(" ",t.location.label," ")}}function te(e,r){e&1&&(a(0,"span",30),c(1,"[Inconnu]"),o())}function ee(e,r){if(e&1&&(a(0,"button",33)(1,"mat-icon",32),c(2,"open_in_new"),o()()),e&2){let t=s(2).$implicit;d("routerLink","/item/"+t.location.id),n(),d("inline",!0)}}function ie(e,r){if(e&1&&p(0,Zt,1,1)(1,te,2,0,"span",30)(2,ee,3,2,"button",33),e&2){let t=s().$implicit;u(t.location?0:1),n(2),u(t.location!=null&&t.location.id?2:-1)}}function ne(e,r){if(e&1&&(a(0,"span"),c(1),o()),e&2){let t=s().$implicit;n(),M(t.date.value)}}function ae(e,r){if(e&1&&(a(0,"span"),c(1),o()),e&2){let t=s().$implicit,i=s().$implicit;n(),M(t[i])}}function oe(e,r){if(e&1&&(a(0,"td",29),p(1,Xt,3,2)(2,Yt,2,1,"span")(3,ie,3,2)(4,ne,2,1,"span")(5,ae,2,1,"span"),o()),e&2){let t,i=s().$implicit,m=s(2);z("data-label",m.getHeaderLabel(i)),n(),u((t=i)==="author"?1:t==="title"?2:t==="location"?3:t==="date"?4:5)}}function re(e,r){if(e&1&&(R(0,22),p(1,Wt,2,1,"th",26)(2,oe,6,2,"td",27),B()),e&2){let t=r.$implicit;d("matColumnDef",t)}}function le(e,r){e&1&&v(0,"tr",34)}function se(e,r){e&1&&v(0,"tr",35)}function ce(e,r){if(e&1){let t=w();a(0,"div",14)(1,"table",21),L(2,re,3,1,"ng-container",22,A),p(4,le,1,0,"tr",23)(5,se,1,0,"tr",24),o(),a(6,"mat-paginator",25,1),b("page",function(m){C(t);let l=s();return x(l.handlePageEvent(m))}),o()()}if(e&2){let t=s();n(),d("dataSource",t.dataSource),n(),$(t.displayedColumns),n(2),d("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),n(),d("matRowDefColumns",t.displayedColumns),n(),d("length",t.length)("pageSize",t.pageSize)("disabled",t.disabled)("showFirstLastButtons",t.showFirstLastButtons)("pageSizeOptions",t.showPageSizeOptions?t.pageSizeOptions:S(11,Vt))("hidePageSize",t.hidePageSize)("pageIndex",t.pageIndex)}}var kt={author:e=>e.author?.label,title:e=>e.title?.label,location:e=>e.location?.label,date:e=>e.date?.value},We=(()=>{class e{constructor(){this.database=g(rt),this._liveAnnouncer=g(K),this.csv=g(wt),this.lang=g(ot),this.displayedColumns=["author","title","location","date"],this.dataSource=new Ct,this.isMobile=window.innerWidth<=600,this.biblioHU="Bibliography Harmonia Universalis",this.authorHeader="Author",this.titleHeader="Title",this.locationHeader="Location",this.dateHeader="Date",this.behavior$=new O(""),this.length=50,this.pageSize=25,this.pageIndex=0,this.pageSizeOptions=[10,25,50,100,500,1e3],this.hidePageSize=!1,this.showPageSizeOptions=!0,this.showFirstLastButtons=!0,this.disabled=!1,this.isSpinner=!0,this.myLang="%20.%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22"+this.lang.selectedLang+"%22%2C%22en%22.%20%7D%0A%7D%0A"}getHeaderLabel(t){switch(t){case"author":return this.authorHeader;case"title":return this.titleHeader;case"location":return this.locationHeader;case"date":return this.dateHeader;default:return t}}ngOnInit(){this.isSpinner=!0,console.log("Spinner ON"),window.addEventListener("resize",()=>{this.isMobile=window.innerWidth<=600}),this.dataSource.sortingDataAccessor=(l,_)=>kt[_]?kt[_](l)||"":l[_]||"",this.dataSource.sortData=(l,_)=>{let f=_.active,P=_.direction;return!f||P===""?l:l.slice().sort((Et,It)=>{let zt=this.dataSource.sortingDataAccessor(Et,f),At=this.dataSource.sortingDataAccessor(It,f),D=zt.localeCompare(At,"fr",{sensitivity:"base"});return P==="asc"?D:-D})},this.biblioHU=this.lang.biblioHU(this.biblioHU),this.authorHeader=this.lang.authorHeader(this.authorHeader),this.titleHeader=this.lang.titleHeader(this.titleHeader),this.locationHeader=this.lang.locationHeader(this.locationHeader),this.dateHeader=this.lang.dateHeader(this.dateHeader);let t=this.database.sparqlBuilding(this.myLang),i=this.database.newSparqlAdress(t);this.database.initBiblioData(i);let m=this.database.getBiblioData();this.dataSource$=k([this.behavior$,m]).pipe(U(l=>(this.dataSource.filter=l[0],this.dataSource.data=l[1],this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.dataSource))),this.dataSource$.subscribe(l=>{console.log("Spinner OFF"),this.isSpinner=!1})}onClick(t){let i=t;i=this.database.databaseToDownload(t);let m=this.csv.arrayToCsv(i);this.csv.downloadBlob(m,"biblio_harmonia_universalis","text/csv;charset=utf-8;")}applyFilter(t){let i=t.target.value.trim().toLowerCase();this.dataSource.filter=i,this.dataSource.filteredData,this.filtered=this.dataSource.filteredData[0].author.label}handlePageEvent(t){this.pageEvent=t,this.length=t.length,this.pageSize=t.pageSize,this.pageIndex=t.pageIndex}setPageSizeOptions(t){t&&(this.pageSizeOptions=t.split(",").map(i=>+i))}setSort(t){this.sort.active===t?this.sort.direction=this.sort.direction==="asc"?"desc":"asc":(this.sort.active=t,this.sort.direction="asc"),this.sort.sortChange.emit({active:this.sort.active,direction:this.sort.direction})}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=E({type:e,selectors:[["app-harmonia-universalis"]],viewQuery:function(i,m){if(i&1&&(H(y,5),H(Lt,5)),i&2){let l;T(l=F())&&(m.sort=l.first),T(l=F())&&(m.paginator=l.first)}},standalone:!0,features:[V],decls:33,vars:11,consts:[["content",""],["paginator",""],["href",I`https://fonts.googleapis.com/icon?family=Material+Icons`,"rel","stylesheet"],[1,"cardBackground"],[1,"hu-header"],[1,"hu-title"],[1,"search-center"],[3,"routerLink"],["appearance","outlined",1,"mat-elevation-z12"],[1,"labelTitlePadding"],["appearance","outline"],["matInput","","placeholder","Search",3,"keyup"],["class","mobile-sort-buttons",4,"ngIf"],["mode","indeterminate","color","primary","diameter","50",2,"margin","2rem auto","display","block"],[1,"mat-elevation-z8","container"],["mat-icon-button","","color","primary",1,"internalLink",3,"click"],["color","primary",3,"inline"],[1,"mobile-sort-buttons"],["mat-button","","class","sort-btn",3,"color","click",4,"ngFor","ngForOf"],["mat-button","",1,"sort-btn",3,"click","color"],[4,"ngIf"],["mat-table","","matSort","","matSortActive","title","matSortDirection","asc",1,"mat-table",3,"dataSource"],[3,"matColumnDef"],["mat-header-row","","class","mat-header-row",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","responsive-row",4,"matRowDef","matRowDefColumns"],["aria-label","Select page",1,"demo-paginator",3,"page","length","pageSize","disabled","showFirstLastButtons","pageSizeOptions","hidePageSize","pageIndex"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","responsive-cell",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"responsive-cell"],[1,"text-muted"],["mat-icon-button","","matTooltip","Voir l'auteur dans la base de donn\xE9es",1,"compact-icon-btn",3,"routerLink"],["color","primary",1,"small-icon",3,"inline"],["mat-icon-button","","matTooltip","Voir le lieu dans la base de donn\xE9es",1,"compact-icon-btn",3,"routerLink"],["mat-header-row","",1,"mat-header-row"],["mat-row","",1,"responsive-row"]],template:function(i,m){if(i&1){let l=w();a(0,"head"),v(1,"link",2),o(),a(2,"body")(3,"div",3)(4,"div",4)(5,"div",5),c(6),o(),a(7,"div",6)(8,"a",7),c(9,"Accueil"),o(),a(10,"span"),c(11,"\xA0|\xA0"),o(),a(12,"a",7),c(13,"Prosopography"),o(),a(14,"span"),c(15,"\xA0|\xA0"),o(),a(16,"a",7),c(17,"FactGrid"),o()()()(),a(18,"mat-card",8)(19,"mat-card-content",3)(20,"div",9)(21,"mat-form-field",10)(22,"input",11),b("keyup",function(f){return C(l),x(m.applyFilter(f))}),o()()(),p(23,qt,2,1,"div",12)(24,Nt,1,0,"mat-progress-spinner",13)(25,ce,8,12,"div",14),a(26,"div")(27,"span")(28,"button",15,0),b("click",function(){return C(l),x(m.onClick(m.dataSource.filteredData))}),a(30,"mat-icon",16),c(31,"download"),o()(),c(32," \xA0\xA0\xA0\xA0\xA0\xA0 "),o()()()()()}i&2&&(n(6),h(" ",m.biblioHU," "),n(2),d("routerLink",S(8,$t)),n(4),d("routerLink",S(9,Rt)),n(4),d("routerLink",S(10,Bt)),n(7),d("ngIf",m.isMobile),n(),u(m.isSpinner?24:-1),n(),u(m.isSpinner?-1:25),n(5),d("inline",!0))},dependencies:[q,Q,j,gt,lt,ct,_t,mt,st,ut,dt,pt,ht,ft,Tt,y,Ht,Y,X,et,Z,tt,at,it,nt,J,G,Ut,Ot,St,bt,xt,vt,N,W,Ft,yt,Mt,Dt,Pt],styles:['.mat-elevation-z8.container[_ngcontent-%COMP%]{width:100%;overflow-x:auto}.mat-table[_ngcontent-%COMP%]{font-size:1em}th.mat-header-cell[_ngcontent-%COMP%]{white-space:nowrap;padding:12px 8px;font-size:1em;vertical-align:middle}.mat-sort-header-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start}.mat-sort-header-arrow[_ngcontent-%COMP%], .mat-sort-header-indicator[_ngcontent-%COMP%]{color:#1976d2;transition:color .2s}@media (max-width: 600px){.mat-table[_ngcontent-%COMP%]{font-size:.95em}th.mat-header-cell[_ngcontent-%COMP%]{white-space:nowrap;padding:8px 4px;font-size:1em;vertical-align:middle}.mat-sort-header-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start}.mat-sort-header-arrow[_ngcontent-%COMP%], .mat-sort-header-indicator[_ngcontent-%COMP%]{opacity:1!important;color:#1976d2!important;font-size:1.2em;margin-left:2px}.mat-header-row[_ngcontent-%COMP%]{display:none}.responsive-cell[_ngcontent-%COMP%]{display:block;width:100%;margin:16px 0;border:0 none;position:relative;padding:0 16px 0 110px}.responsive-cell[_ngcontent-%COMP%]:before{content:attr(data-label) ": ";position:absolute;left:16px;top:0;font-weight:700;color:#666;white-space:nowrap}.responsive-row[_ngcontent-%COMP%]{display:block;overflow:hidden;height:auto;position:relative;box-shadow:0 2px 1px -1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f;border-radius:3px;margin-bottom:24px}.responsive-row[_ngcontent-%COMP%] + .responsive-row[_ngcontent-%COMP%]{margin-top:24px}mat-paginator[_ngcontent-%COMP%]{margin-top:24px}.mobile-sort-buttons[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;gap:2px;justify-content:center;margin-bottom:12px}.sort-btn[_ngcontent-%COMP%]{min-width:unset;padding:2px 6px;font-size:.95em;line-height:1.2;border:none;box-shadow:none;background:transparent}.sort-btn[_ngcontent-%COMP%]:focus{outline:none}.sort-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-left:2px;font-size:1em}}'],changeDetection:0})}}return e})();export{We as HarmoniaUniversalisComponent};
